<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Modelling Changing Variance in Time Series | Ray</title>
<meta name="keywords" content="Public Health, ggplot, Shiny Server">
<meta name="description" content="Modelling Changing Variance in Time Series">
<meta name="author" content="Theme PaperMod">
<link rel="canonical" href="https://adityatelange.github.io/hugo-PaperMod/posts/variancemodelling/">
<link crossorigin="anonymous" href="/hugo-PaperMod/assets/css/stylesheet.fc033e5c5d4a80e735641b03e9471fae673d6ceee3a62a675e35a9553a755201.css" integrity="sha256-/AM&#43;XF1KgOc1ZBsD6Ucfrmc9bO7jpipnXjWpVTp1UgE=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://adityatelange.github.io/hugo-PaperMod/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://adityatelange.github.io/hugo-PaperMod/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://adityatelange.github.io/hugo-PaperMod/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://adityatelange.github.io/hugo-PaperMod/apple-touch-icon.png">
<link rel="mask-icon" href="https://adityatelange.github.io/hugo-PaperMod/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js" integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js" integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa" crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
            delimiters: [
                {left: "$$", right: "$$", display: true},
                {left: "$", right: "$", display: false}
            ]
        });
    });
</script>

<meta property="og:title" content="Modelling Changing Variance in Time Series" />
<meta property="og:description" content="Modelling Changing Variance in Time Series" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://adityatelange.github.io/hugo-PaperMod/posts/variancemodelling/" /><meta property="og:image" content="https://adityatelange.github.io/hugo-PaperMod/papermod-cover.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-11-07T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-11-07T00:00:00+00:00" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://adityatelange.github.io/hugo-PaperMod/papermod-cover.png"/>

<meta name="twitter:title" content="Modelling Changing Variance in Time Series"/>
<meta name="twitter:description" content="Modelling Changing Variance in Time Series"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://adityatelange.github.io/hugo-PaperMod/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Modelling Changing Variance in Time Series",
      "item": "https://adityatelange.github.io/hugo-PaperMod/posts/variancemodelling/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Modelling Changing Variance in Time Series",
  "name": "Modelling Changing Variance in Time Series",
  "description": "Modelling Changing Variance in Time Series",
  "keywords": [
    "Public Health, ggplot, Shiny Server"
  ],
  "articleBody": "Exposition of forecasting methods for modelling changing variance in time series\nAbstract This project is based on exploring ARCH /GARCH methods and their application in modelling the changing variance of time in predicting stock prices. The data used in this study is obtained from the S\u0026P 500 index, which is a measure that estimates the performance of 500 companies listed in the United States Stock exchange market. The data used includes daily data spanning the years 2013 - 2018.\nIntroduction - ARIMA models The first phase of this analysis begins with the exploration of an ARIMA, where ARIMA stands for Auto Regressive Moving Average models. They consist of two components; the Autoregressive Component and the Moving Average Component and are denoted as ARIMA(p,d,q), with p representing the number of autoregressive terms, d the number of differencing and q the number of Moving Average terms. The second phase involves the checking of model residuals (to look for volatile clusters) followed by an eventual transition to ARCH/GARCH.\nBefore we begin any model fitting, we make the line graphs shown below. This step is meant as an initial exploration aimed at showing the trends in volume and price of Chesapeake Energy Corporation’s stocks. All the plots below are similar because they show that the volume, opening, high and low values exhibited high volatility. Volatility in a time series refers to the phenomenon where the conditional variance of a time series varies over time (Cryer and Chan, 2008). Stock volume seems more volatile than low, high and close prices, as can be seen from the more sudden irregular shifts in trends with time.\nThe data wrangling required before fitting the model/ checking conditions is minimal. It begins by decomposing Chesapeake monthly data time series into seasonal, trend and irregular components, then moves on to the removal of seasonal components to create a seasonally adjusted component.\nInsert image here\nModel Conditons Before fitting an ARIMA time series model, we need to make sure that it is free of trends and non seasonal behavior. We also check to make sure that the time series has a constant mean and variance. If variation in trends is present, we difference in order to get rid of those trends and prepare the data for model fitting. After all these checks are performed, we run the Augmented Dickey Fuller test to make sure that stationarity is satisfied:\nThe hypothesis test to check whether our data is stationary is as follows:\n $H_0$: Chesapeake time series is not stationary.  $H_A$: Chesapeake time series is stationary. Our test yields a statistic of −3.5423 and a p value of 0.03823. We therefore reject the null as there is strong evidence of stationarity in the data, and proceed to the model fitting phase.\n#adf test checks whether ts is stationary or not (data condition) adf.test(CHK_deseasonal_value, alternative = \"stationary\")  ## ## Augmented Dickey-Fuller Test ## ## data: CHK_deseasonal_value ## Dickey-Fuller = -3.5423, Lag order = 10, p-value = 0.03823 ## alternative hypothesis: stationary  Model Fitting Here, we use the Auto.arima() function to help obtain model parameters using a stepwise model fitting procedure. This model selection procedure selects the model with the lowest AIC value. The p, d, q parameters of the model will be selected from the model with the lowest score. We start with a maximum order of 6 for all parameters and iterate through different combinations to find one that produces the model with the lowest AIC score:\n#auto fits arima model CHK_fit = auto.arima(CHK_deseasonal_value, max.order = 6) CHK_fit  ## Series: CHK_deseasonal_value ## ARIMA(4,1,3) ## ## Coefficients: ## ar1 ar2 ar3 ar4 ma1 ma2 ma3 ## 0.2097 0.3550 0.6572 -0.4885 0.2163 -0.3094 -0.7638 ## s.e. 0.0449 0.0418 0.0359 0.0263 0.0468 0.0452 0.0373 ## ## sigma^2 estimated as 1.864e+12: log likelihood=-19460.3 ## AIC=38936.59 AICc=38936.71 BIC=38977.65  The model chosen from our selection procedure has 4 Autoregressive Terms i.e AR(4), a differencing of degree 1 and 3 moving average terms i.e MA(3). The fitted model from the parameters obtained above can be expressed as :\n $$\\hat{Y}_{t} = 0.2097 Y_{t-1}+0.3550 Y_{t-2}+0.6572 Y_{t-3}-0.4885 Y_{t-4}+0.2163 e_{t-1}-0.3094 e_{t-2}-0.7638 e_{t-3}+\\epsilon$$ The equation above is a linear combination of terms. The Y’s correspond to recent stock volume values up until the $(t-4)^{th}$ time step while the $e$’s correspond to the errors of the lags at the denoted, corresponding time steps.\nIn the next section we shall examine sample partial autocorrelation (PACF) and sample autocorrelation plots (ACF) to validate our choices of the p, d and q orders chosen for our ARIMA model by the stepwise model selection procedure.\nModel Diagnostics Before settling down on the model obtained from the previous section, we examine the auto correlation of residuals to make sure our model is free of auto correlations. This is necessary because it helps us establish whether the noise terms in the model are independent from each other:\nggtsdisplay(residuals(CHK_fit), plot.type = \"partial\", main = \"ARIMA (4, 1, 3) Diagnostic plots\")  Insert diagnostic plots here\nA quick examination of the ACF plot reveals the existence of excessive correlations in the residuals at lags 3 and 6. Furthermore, the lag patterns in the PACF are quite similar to those in the ACF plot, suggesting the existence of autocorrelation. This problem in distribution of error terms also manifests itself in the residuals, and can be seen from the unequal variation of error terms across the range of values in the residual plot.\nIn order to confirm the findings from the diagnostic plots above, we conduct an official hypothesis test for model fit using the Ljung - Box test to see whether the error terms in the model are independently and identically distributed (i.i.d).\nThe Ljung Box test statistic is given by (Glen, 2018): $$Q_* = n(n+2) \\sum_{k=1}^{m} \\frac{r_{k}^{2}}{n-k}$$ where n is the size of the time series and r the residual correlation at the $k^{th}$ lag . $Q_*$ has a chi-square distribution with k-p-q degrees of freedom (Cryer and Chan, 2008). The official hypothesis for the test are as follows:\n$H_0$ : The model error terms are uncorrelated\n$H_A$ : The model error terms are correlated\nBox.test(residuals(CHK_fit), lag = 90, fitdf = 83, type = 'Ljung-Box')  ## ## Box-Ljung test ## ## data: residuals(CHK_fit) ## X-squared = 541, df = 7, p-value  Running the test yields a p value of 2.2e-16. We have sufficient evidence to reject the null, as there is strong evidence that the model assumption of independence of error terms has been violated. In the next section we attempt to find the remedy to this problem by exploring methods that model the changing variance in time series.\nARCH/ GARCH models Introduction In the previous chapter we tried fitting and assessing the feasibility of an ARIMA model on Chesapeake Energy Corporation’s stock data. The fitted model wasn’t appropriate because the model’s error terms were not independent and identically distributed. In addition, cluster volatility seemed to be a huge issue as observed from the heteroschedastic nature of modeled stock volume returns.\nIn this section we will use autoregressive conditional heteroschedastic models in an attempt to adequately capture and account for the heteroscedasticity observed in the ARIMA model. ARCH/GARCH are time series models used to model processes where volatility is high in provided data (Cryer and Chan, 2008). Cases involving stock market data are usually prone to unpredictable changes, and are best modeled using methods that model the variability of future values based on present and past provided trends in observed returns.\n1. ARCH models ARCH models are denoted ARCH(p), where p represents the order of the model. According to Cryer and Chan (2008) an ARCH(1) process modelling the return of a time series r takes the form $r_{t}=\\sigma_{t | t-1} \\varepsilon_{t}$ where $\\varepsilon_{t}$ is a series of independent and identically distributed random variables with a mean of zero and standard deviation of 1. The quantity $\\sigma_{t | t-1}$ models the conditional variance, $\\sigma_{t | t-1}^{2}$, of the return $r_{t}$, and is given by $\\sigma_{t | t-1}^{2}=\\omega+\\alpha r_{t-1}^{2}$. The variance of the current return is based on conditioning upon returns until the ${(t-1)}^{th}$ time step. The quantities $\\omega$ and $\\alpha$ represent the ARCH model intercept and coefficient respectively.\nThe diagram below represents a sample ARCH(1) process simulated with $\\omega$ = 0.1 and $\\alpha$ = 0.5 as the chosen model parameters.\nset.seed(85) garch01.sim = garch.sim(alpha=c(.1,.5),n=400) sim_data  Insert Simulated arch process image\n2. GARCH models The ARCH model introduced in the previous section models future returns by conditioning the value of the variance at time t to the previous time step alone i.e $\\sigma_{t | t-1}^{2}=\\omega+\\alpha r_{t-1}^{2}$. Bollerslev’s (1986) approach encourages the backward extension of this conditioning process up until the $q^{th}$ time step as well as the introduction of p lags to the conditional variance (Cryer and Chan, 2008). This resulting model becomes a Generalized Autoregressive Conditional Heteroscedasticity (GARCH) process, and is denoted as GARCH(p,q). The return from this new proposed model takes the same form as ARCH’s $r_{t}=\\sigma_{t | t-1} \\varepsilon_{t}$. However, the conditional variance $\\sigma^2_{t | t-1}$ modeled by the quantity $\\sigma_{t | t-1}$ now becomes : $$\\begin{aligned} \\sigma_{t | t-1}^{2}=\\omega+\\beta_{1} \\sigma_{t-1 | t-2}^{2}+\\cdots+\u0026 \\beta_{p} \\sigma_{t-p | t-p-1}^{2}+\\alpha_{1} r_{t-1}^{2}+\\alpha_{2} r_{t-2}^{2}+\\cdots+\\alpha_{q} r_{t-q}^{2} \\end{aligned}$$\nThe $\\beta$ coefficients in the model are used to assign weights to the lags of the conditioned variance values.\nThe plot below (Cryer and Chan, 2008) illustrates an example of a simulated GARCH(1,1) process with parameter values $$\\omega=0.02, \\alpha=0.05, \\text { and } \\beta = 0.9$$\nInsert simulated garch process\nThe parameters $\\omega, \\beta, \\alpha$ in GARCH and $\\omega, \\alpha$ in ARCH are constrained to $0$, since the conditional variances have to be positive.\nEstimation of GARCH model coefficents GARCH model coefficients are fit using the Maximum Likelihood Approach. The estimation process used to obtain the likelihood estimates for $\\omega, \\beta, \\alpha$ is based on recursively iterating through the log likelihood function modelling the GARCH coefficient estimates. The log likelihood function we aim to maximize is defined as (Cryer and Chan, 2008):\n$$L(\\omega, \\alpha, \\beta)=-\\frac{n}{2} \\log (2 \\pi)-\\frac{1}{2} \\sum_{i=1}^{n}\\left\\{\\log \\left(\\sigma_{t-1 | t-2}^{2}\\right)+r_{t}^{2} / \\sigma_{t | t-1}^{2}\\right\\}$$ Model Fitting Below, we try fitting an appropriate GARCH model using the ugarchfit() function from the rugarch package. The package computes the model estimates using the maximum likelihood function specified in the previous section.\nWe will explore different GARCH orders, with the aim of finding the model that best fits the data. The orders we will try are arbitrarily chosen as GARCH(1,1), GARCH(2,2)and GARCH(3,3):\nModel Diagnostics The GARCH(1,1) model seems like the most appropriate here since all but one of it’s model coefficients are significant. Furthermore, it has the lowest AIC of all the models explored.\nBefore we accept the model we found in the previous section we need to make sure that assumptions have been met for the ARCH(1,1) model. The squared residuals need to be serially uncorrelated and the error terms should be normally distributed:\n#QQplot to check for normality qqnorm(residuals(fit_mod1)); qqline(residuals(fit_mod1)) Insert QQ plot here\n#Sample acf and pacf plots to check iid assumption ggtsdisplay(residuals(fit_mod1), plot.type = \"partial\", main = \"Chesapeak Energy Corporation's GARCH (1, 1) Diagnostic plots\") Insert Another diagnostic plot\nFrom the diagnostic plots made above, we see a major problem with normality, as most of the points on the qqplot veer off the line. In addition, there seems to be major issues with independence, as can be seen from the significant lags in residuals from the autocorrelation plots.\nResults From the model diagnostics we ran in the previous section, we discovered major issues with normality and independence in error terms. We might want to explore more model parameters to see whether we can find a model that improves upon what we currently have. For now, we will proceed with extreme caution and use the GARCH(1,1) model to make some predictions.\nBelow, we extract the coefficients from the chosen GARCH(1,1) model.\n#Extract coefficients fit_mod1@fit$matcoef ## Estimate Std. Error t value Pr(|t|) ## mu 16.96828513 0.03046360 557.001998 0.000000e+00 ## omega 0.04592897 0.01059138 4.336448 1.448039e-05 ## alpha1 0.40407479 0.05760516 7.014559 2.306821e-12 ## beta1 0.51414297 0.06573577 7.821358 5.329071e-15 The return at time t as given by our model is going to be given by (Boudt, 2020) : $$R_{t} = 16.97 +e_{t}$$ where the $e_{t}$ is a normally distributed random variable with a mean of 0 and variance of $\\widehat{\\sigma}_{t}^{2}$ i.e $e_{t} \\sim N\\left(0, \\widehat{\\sigma}_{t}^{2}\\right)$. The variance modelling return volatility at the $t^{th}$ time step in our fitted model is going to be $\\widehat{\\sigma}_{t}^{2}=0.05+0.40 e_{t-1}^{2}+0.51 \\widehat{\\sigma}_{t-1}^{2}$\nThe ugarchroll() function is used to obtain estimates for the last four dates in the data set. The test data that is used is the most recent week’s returns in stock volume. The log volume residuals obtained after this process are printed down below :\n#Forecasting using the ugarchforecast function preds = ugarchforecast(fit_mod1, n.ahead = 1, data = CHK[1255:1259, ,drop = F][,6]) preds = ugarchroll(spec = spec_mod1 , data = log(CHK_ts) , n.start = 1255 , refit.every = 2 , refit.window = 'moving') References  Cryer, J. D., \u0026 Chan, K.-sik. (2008). Time series analysis with applications in R. New York: Springer. Nugent, C. (n.d.). S\u0026P 500 stock data. Retrieved from https://www.kaggle.com/camnugent/sandp500. Boudt, K. (n.d.). GARCH Models in R. Retrieved from https://www.datacamp.com/courses/garch-models-in-r. Trapletti, A., \u0026 Hornik, K. (n.d.). Package ‘tseries.’ Retrieved from https://cran.r-project.org/web/packages/tseries/tseries.pdf Ghalanos, A., \u0026 Kley, T. (n.d.). Package ‘rugarch.’ Retrieved from https://cran.r-project.org/web/packages/rugarch/rugarch.pdf Glen, S. (2018, September 11). Ljung Box Test: Definition. Retrieved from https://www.statisticshowto.datasciencecentral.com/ljung-box-test/ Bollerslev, T. (1986). Generalized autoregressive conditional heteroskedasticity. Journal of Econometrics, 31(3), 307–327. doi: 10.1016/0304-4076(86)90063-1   .emojify { font-family: Apple Color Emoji, Segoe UI Emoji, NotoColorEmoji, Segoe UI Symbol, Android Emoji, EmojiSymbols; font-size: 2rem; vertical-align: middle; } @media screen and (max-width:650px) { .nowrap { display: block; margin: 25px 0; } } ",
  "wordCount" : "2264",
  "inLanguage": "en",
  "datePublished": "2020-11-07T00:00:00Z",
  "dateModified": "2020-11-07T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Theme PaperMod"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://adityatelange.github.io/hugo-PaperMod/posts/variancemodelling/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Ray",
    "logo": {
      "@type": "ImageObject",
      "url": "https://adityatelange.github.io/hugo-PaperMod/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://adityatelange.github.io/hugo-PaperMod/" accesskey="h" title="Ray (Alt + H)">Ray</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://adityatelange.github.io/hugo-PaperMod/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://adityatelange.github.io/hugo-PaperMod/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      Modelling Changing Variance in Time Series
    </h1>
    <div class="post-description">
      Modelling Changing Variance in Time Series
    </div>
    <div class="post-meta"><span title='2020-11-07 00:00:00 +0000 UTC'>November 7, 2020</span>&nbsp;·&nbsp;11 min&nbsp;·&nbsp;Theme PaperMod&nbsp;|&nbsp;<a href="https://github.com/adityatelange/hugo-PaperMod/tree/exampleSite/content/posts/VarianceModelling.md" rel="noopener noreferrer" target="_blank">Suggest Changes</a>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#abstract" aria-label="Abstract">Abstract</a></li>
                <li>
                    <a href="#introduction---arima-models" aria-label="Introduction - ARIMA models">Introduction - ARIMA models</a><ul>
                        
                <li>
                    <a href="#model-conditons" aria-label="Model Conditons">Model Conditons</a></li>
                <li>
                    <a href="#model-fitting" aria-label="Model Fitting">Model Fitting</a></li>
                <li>
                    <a href="#model-diagnostics" aria-label="Model Diagnostics">Model Diagnostics</a></li></ul>
                </li>
                <li>
                    <a href="#arch-garch-models" aria-label="ARCH/ GARCH models">ARCH/ GARCH models</a><ul>
                        
                <li>
                    <a href="#introduction" aria-label="Introduction">Introduction</a><ul>
                        
                <li>
                    <a href="#1-arch-models" aria-label="1. ARCH models">1. ARCH models</a></li>
                <li>
                    <a href="#2-garch-models" aria-label="2. GARCH models">2. GARCH models</a><ul>
                        
                <li>
                    <a href="#estimation-of-garch-model-coefficents" aria-label="Estimation of GARCH model coefficents">Estimation of GARCH model coefficents</a></li>
                <li>
                    <a href="#model-fitting-1" aria-label="Model Fitting">Model Fitting</a></li>
                <li>
                    <a href="#model-diagnostics-1" aria-label="Model Diagnostics">Model Diagnostics</a></li>
                <li>
                    <a href="#results" aria-label="Results">Results</a></li></ul>
                </li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#references" aria-label="References">References</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><p>Exposition of forecasting methods for modelling changing variance in time series</p>
<h3 id="abstract">Abstract<a hidden class="anchor" aria-hidden="true" href="#abstract">#</a></h3>
<p>This project is based on exploring ARCH /GARCH methods and their application in modelling the changing variance of time in predicting stock prices. The data used in this study is obtained from the S&amp;P 500 index, which is a measure that estimates the performance of 500 companies listed in the United States Stock exchange market. The data used includes daily data spanning the years 2013 - 2018.</p>
<h3 id="introduction---arima-models">Introduction - ARIMA models<a hidden class="anchor" aria-hidden="true" href="#introduction---arima-models">#</a></h3>
<p>The first phase of this analysis begins with the exploration of an ARIMA, where ARIMA stands for Auto Regressive Moving Average models. They consist of two components; the Autoregressive Component and the Moving Average Component and are denoted as <code>ARIMA(p,d,q)</code>, with p representing the number of autoregressive terms, d the number of differencing and q the number of Moving Average terms. The second phase involves the checking of model residuals (to look for volatile clusters) followed by an eventual transition to ARCH/GARCH.</p>
<p>Before we begin any model fitting, we make the line graphs shown below. This step is meant as an initial exploration aimed at showing the trends in volume and price of Chesapeake Energy Corporation’s stocks. All the plots below are similar because they show that the volume, opening, high and low values exhibited high volatility. Volatility in a time series refers to the phenomenon where the conditional variance of a time series varies over time (Cryer and Chan, 2008). Stock volume seems more volatile than low, high and close prices, as can be seen from the more sudden irregular shifts in trends with time.</p>
<p>The data wrangling required before fitting the model/ checking conditions is minimal. It begins by decomposing Chesapeake monthly data time series into seasonal, trend and irregular components, then moves on to the removal of seasonal components to create a seasonally adjusted component.</p>
<p>Insert image here</p>
<p><img loading="lazy" src="images/img1.jpg" alt="Img_1"  />
</p>
<h4 id="model-conditons">Model Conditons<a hidden class="anchor" aria-hidden="true" href="#model-conditons">#</a></h4>
<p>Before fitting an ARIMA time series model, we need to make sure that it is free of trends and non seasonal behavior. We also check to make sure that the time series has a constant mean and variance. If variation in trends is present, we difference in order to get rid of those trends and prepare the data for model fitting. After all these checks are performed, we run the Augmented Dickey Fuller test to make sure that stationarity is satisfied:</p>
<p>The hypothesis test to check whether our data is stationary is as follows:</p>

<p>
$H_0$: Chesapeake time series is not stationary.
</p>

<p>
$H_A$: Chesapeake time series is stationary.
</p>


<p>Our test yields a statistic of −3.5423 and a p value of 0.03823. We therefore reject the null as there is strong evidence of stationarity in the data, and proceed to the model fitting phase.</p>
<pre class="r"><code>#adf test checks whether ts is stationary or not (data condition)
adf.test(CHK_deseasonal_value, alternative = "stationary") 
</code></pre>
<pre class="r"><code>## 
##  Augmented Dickey-Fuller Test
## 
## data:  CHK_deseasonal_value
## Dickey-Fuller = -3.5423, Lag order = 10, p-value = 0.03823
## alternative hypothesis: stationary 
</code></pre>
<h4 id="model-fitting">Model Fitting<a hidden class="anchor" aria-hidden="true" href="#model-fitting">#</a></h4>
<p>Here, we use the <code>Auto.arima()</code> function to help obtain model parameters using a stepwise model fitting procedure. This model selection procedure selects the model with the lowest AIC value. The p, d, q parameters of the model will be selected from the model with the lowest score. We start with a maximum order of 6 for all parameters and iterate through different combinations to find one that produces the model with the lowest AIC score:</p>
<pre class="r"><code>#auto fits arima model
CHK_fit = auto.arima(CHK_deseasonal_value, max.order = 6) 
CHK_fit 
</code></pre>
<pre class="r"><code>## Series: CHK_deseasonal_value 
## ARIMA(4,1,3) 
## 
## Coefficients:
##          ar1     ar2     ar3      ar4     ma1      ma2      ma3
##       0.2097  0.3550  0.6572  -0.4885  0.2163  -0.3094  -0.7638
## s.e.  0.0449  0.0418  0.0359   0.0263  0.0468   0.0452   0.0373
## 
## sigma^2 estimated as 1.864e+12:  log likelihood=-19460.3
## AIC=38936.59   AICc=38936.71   BIC=38977.65 
</code></pre>
<p>The model chosen from our selection procedure has 4 Autoregressive Terms i.e AR(4), a differencing of degree 1 and 3 moving average terms i.e MA(3). The fitted model from the parameters obtained above can be expressed as :</p>


<p>
  $$\hat{Y}_{t} = 0.2097 Y_{t-1}+0.3550 Y_{t-2}+0.6572 Y_{t-3}-0.4885 Y_{t-4}+0.2163 e_{t-1}-0.3094 e_{t-2}-0.7638 e_{t-3}+\epsilon$$
</p>


<p>The equation above is a linear combination of terms. The Y’s correspond to recent stock volume values up until the $(t-4)^{th}$ time step while the $e$&rsquo;s correspond to the errors of the lags at the denoted, corresponding time steps.</p>
<p>In the next section we shall examine sample partial autocorrelation (PACF) and sample autocorrelation plots (ACF) to validate our choices of the p, d and q orders chosen for our ARIMA model by the stepwise model selection procedure.</p>
<h4 id="model-diagnostics">Model Diagnostics<a hidden class="anchor" aria-hidden="true" href="#model-diagnostics">#</a></h4>
<p>Before settling down on the model obtained from the previous section, we examine the auto correlation of residuals to make sure our model is free of auto correlations. This is necessary because it helps us establish whether the noise terms in the model are independent from each other:</p>
<pre class="r"><code>ggtsdisplay(residuals(CHK_fit), plot.type = "partial",
            main = "ARIMA (4, 1, 3) Diagnostic plots") 
</code></pre>
<p>Insert diagnostic plots here</p>
<p>A quick examination of the ACF plot reveals the existence of excessive correlations in the residuals at lags 3 and 6. Furthermore, the lag patterns in the PACF are quite similar to those in the ACF plot, suggesting the existence of autocorrelation. This problem in distribution of error terms also manifests itself in the residuals, and can be seen from the unequal variation of error terms across the range of values in the residual plot.</p>
<p>In order to confirm the findings from the diagnostic plots above, we conduct an official hypothesis test for model fit using the Ljung - Box test to see whether the error terms in the model are independently and identically distributed (i.i.d).</p>
<p>The Ljung Box test statistic is given by (Glen, 2018): $$Q_* = n(n+2) \sum_{k=1}^{m} \frac{r_{k}^{2}}{n-k}$$ where n is the size of the time series and r the residual correlation at the $k^{th}$ lag . $Q_*$ has a chi-square distribution with k-p-q degrees of freedom (Cryer and Chan, 2008). The official hypothesis for the test are as follows:</p>
<p>$H_0$ : The model error terms are uncorrelated</p>
<p>$H_A$ : The model error terms are correlated</p>
<pre class="r"><code>Box.test(residuals(CHK_fit), lag = 90, fitdf = 83, type = 'Ljung-Box')
</code></pre>
<pre class="r"><code>## 
##  Box-Ljung test
## 
## data:  residuals(CHK_fit)
## X-squared = 541, df = 7, p-value < 2.2e-16
</code></pre>
<p>Running the test yields a p value of 2.2e-16. We have sufficient evidence to reject the null, as there is strong evidence that the model assumption of independence of error terms has been violated. In the next section we attempt to find the remedy to this problem by exploring methods that model the changing variance in time series.</p>
<h3 id="arch-garch-models">ARCH/ GARCH models<a hidden class="anchor" aria-hidden="true" href="#arch-garch-models">#</a></h3>
<h4 id="introduction">Introduction<a hidden class="anchor" aria-hidden="true" href="#introduction">#</a></h4>
<p>In the previous chapter we tried fitting and assessing the feasibility of an ARIMA model on Chesapeake Energy Corporation’s stock data. The fitted model wasn’t appropriate because the model’s error terms were not independent and identically distributed. In addition, cluster volatility seemed to be a huge issue as observed from the heteroschedastic nature of modeled stock volume returns.</p>
<p>In this section we will use autoregressive conditional heteroschedastic models in an attempt to adequately capture and account for the heteroscedasticity observed in the ARIMA model. ARCH/GARCH are time series models used to model processes where volatility is high in provided data (Cryer and Chan, 2008). Cases involving stock market data are usually prone to unpredictable changes, and are best modeled using methods that model the variability of future values based on present and past provided trends in observed returns.</p>
<h5 id="1-arch-models">1. ARCH models<a hidden class="anchor" aria-hidden="true" href="#1-arch-models">#</a></h5>
<p>ARCH models are denoted <code>ARCH(p)</code>, where p represents the order of the model. According to Cryer and Chan (2008) an <code>ARCH(1)</code> process modelling the return of a time series r takes the form $r_{t}=\sigma_{t | t-1} \varepsilon_{t}$ where $\varepsilon_{t}$ is a series of independent and identically distributed random variables with a mean of zero and standard deviation of 1. The quantity $\sigma_{t | t-1}$ models the conditional variance, $\sigma_{t | t-1}^{2}$, of the return $r_{t}$, and is given by $\sigma_{t | t-1}^{2}=\omega+\alpha r_{t-1}^{2}$. The variance of the current return is based on conditioning upon returns until the ${(t-1)}^{th}$ time step. The quantities $\omega$ and $\alpha$ represent the ARCH model intercept and coefficient respectively.</p>
<p>The diagram below represents a sample <code>ARCH(1)</code> process simulated with $\omega$ = 0.1 and $\alpha$ = 0.5 as the chosen model parameters.</p>
 <pre class="r"><code>set.seed(85)
garch01.sim = garch.sim(alpha=c(.1,.5),n=400)
sim_data <- data.frame(seq(1,400),garch01.sim )
arch.plt <- ggplot(sim_data, aes(x = seq.1..400., y = garch01.sim )) + geom_line() +
  xlab("Time Step") + ylab("Return at Time Step t") + 
  ggtitle("Simulated ARCH(1) process")
ggplotly(arch.plt)</code></pre>
<p>Insert Simulated arch process image</p>
<h5 id="2-garch-models">2. GARCH models<a hidden class="anchor" aria-hidden="true" href="#2-garch-models">#</a></h5>
<p>The ARCH model introduced in the previous section models future returns by conditioning the value of the variance at time t to the previous time step alone i.e $\sigma_{t | t-1}^{2}=\omega+\alpha r_{t-1}^{2}$. Bollerslev&rsquo;s (1986) approach encourages the backward extension of this conditioning process up until the $q^{th}$ time step as well as the introduction of p lags to the conditional variance (Cryer and Chan, 2008). This resulting model becomes a Generalized Autoregressive Conditional Heteroscedasticity (GARCH) process, and is denoted as <code>GARCH(p,q)</code>. The return from this new proposed model takes the same form as ARCH&rsquo;s $r_{t}=\sigma_{t | t-1} \varepsilon_{t}$. However, the conditional variance $\sigma^2_{t | t-1}$ modeled by the quantity $\sigma_{t | t-1}$ now becomes : $$\begin{aligned}
\sigma_{t | t-1}^{2}=\omega+\beta_{1} \sigma_{t-1 | t-2}^{2}+\cdots+&amp; \beta_{p} \sigma_{t-p | t-p-1}^{2}+\alpha_{1} r_{t-1}^{2}+\alpha_{2} r_{t-2}^{2}+\cdots+\alpha_{q} r_{t-q}^{2}
\end{aligned}$$</p>
<p>The $\beta$ coefficients in the model are used to assign weights to the lags of the conditioned variance values.</p>
<p>The plot below (Cryer and Chan, 2008) illustrates an example of a simulated GARCH(1,1) process with parameter values $$\omega=0.02, \alpha=0.05, \text { and } \beta = 0.9$$</p>
<p>Insert simulated garch process</p>
<p>The parameters $\omega, \beta, \alpha$ in GARCH and $\omega, \alpha$ in ARCH are constrained to $&gt;0$, since the conditional variances have to be positive.</p>
<h6 id="estimation-of-garch-model-coefficents">Estimation of GARCH model coefficents<a hidden class="anchor" aria-hidden="true" href="#estimation-of-garch-model-coefficents">#</a></h6>
<p>GARCH model coefficients are fit using the Maximum Likelihood Approach. The estimation process used to obtain the likelihood estimates for $\omega, \beta, \alpha$ is based on recursively iterating through the log likelihood function modelling the GARCH coefficient estimates. The log likelihood function we aim to maximize is defined as (Cryer and Chan, 2008):</p>


$$L(\omega, \alpha, \beta)=-\frac{n}{2} \log (2 \pi)-\frac{1}{2} \sum_{i=1}^{n}\left\{\log \left(\sigma_{t-1 | t-2}^{2}\right)+r_{t}^{2} / \sigma_{t | t-1}^{2}\right\}$$ 


<h6 id="model-fitting-1">Model Fitting<a hidden class="anchor" aria-hidden="true" href="#model-fitting-1">#</a></h6>
<p>Below, we try fitting an appropriate GARCH model using the <code>ugarchfit()</code> function from the rugarch package. The package computes the model estimates using the maximum likelihood function specified in the previous section.</p>
<p>We will explore different GARCH orders, with the aim of finding the model that best fits the data. The orders we will try are arbitrarily chosen as <code>GARCH(1,1)</code>, <code>GARCH(2,2)</code>and <code>GARCH(3,3)</code>:</p>
<h6 id="model-diagnostics-1">Model Diagnostics<a hidden class="anchor" aria-hidden="true" href="#model-diagnostics-1">#</a></h6>
<p>The <code>GARCH(1,1)</code> model seems like the most appropriate here since all but one of it&rsquo;s model coefficients are significant. Furthermore, it has the lowest AIC of all the models explored.</p>
<p>Before we accept the model we found in the previous section we need to make sure that assumptions have been met for the <code>ARCH(1,1)</code> model. The squared residuals need to be serially uncorrelated and the error terms should be normally distributed:</p>
<pre class="r"><code>#QQplot to check for normality
qqnorm(residuals(fit_mod1)); qqline(residuals(fit_mod1))</code></pre>
<p>Insert QQ plot here</p>
<pre class="r"><code>#Sample acf and pacf plots to check iid assumption
ggtsdisplay(residuals(fit_mod1), plot.type = "partial",
            main = "Chesapeak Energy Corporation's GARCH (1, 1) Diagnostic plots")</code></pre>
<p>Insert Another diagnostic plot</p>
<p>From the diagnostic plots made above, we see a major problem with normality, as most of the points on the qqplot veer off the line. In addition, there seems to be major issues with independence, as can be seen from the significant lags in residuals from the autocorrelation plots.</p>
<h6 id="results">Results<a hidden class="anchor" aria-hidden="true" href="#results">#</a></h6>
<p>From the model diagnostics we ran in the previous section, we discovered major issues with normality and independence in error terms. We might want to explore more model parameters to see whether we can find a model that improves upon what we currently have. For now, we will proceed with extreme caution and use the <code>GARCH(1,1)</code> model to make some predictions.</p>
<p>Below, we extract the coefficients from the chosen <code>GARCH(1,1)</code> model.</p>
<pre class="r"><code>#Extract coefficients
fit_mod1@fit$matcoef</code></pre>
<pre class="r"><code>##           Estimate  Std. Error    t value     Pr(>|t|)
## mu     16.96828513  0.03046360 557.001998 0.000000e+00
## omega   0.04592897  0.01059138   4.336448 1.448039e-05
## alpha1  0.40407479  0.05760516   7.014559 2.306821e-12
## beta1   0.51414297  0.06573577   7.821358 5.329071e-15</code></pre>
<p>The return at time t as given by our model is going to be given by (Boudt, 2020) : $$R_{t} = 16.97 +e_{t}$$ where the $e_{t}$ is a normally distributed random variable with a mean of 0 and variance of $\widehat{\sigma}_{t}^{2}$ i.e $e_{t} \sim N\left(0, \widehat{\sigma}_{t}^{2}\right)$. The variance modelling return volatility at the $t^{th}$ time step in our fitted model is going to be $\widehat{\sigma}_{t}^{2}=0.05+0.40 e_{t-1}^{2}+0.51 \widehat{\sigma}_{t-1}^{2}$</p>
<p>The <code>ugarchroll()</code> function is used to obtain estimates for the last four dates in the data set. The test data that is used is the most recent week&rsquo;s returns in stock volume. The log volume residuals obtained after this process are printed down below :</p>
<pre class="r"><code>#Forecasting using the ugarchforecast function
preds = ugarchforecast(fit_mod1, n.ahead = 1, data = CHK[1255:1259, ,drop = F][,6])
preds = ugarchroll(spec = spec_mod1 , data = log(CHK_ts) , n.start = 1255 , refit.every = 2 , refit.window = 'moving')</code></pre>
<h3 id="references">References<a hidden class="anchor" aria-hidden="true" href="#references">#</a></h3>
<ol>
<li>Cryer, J. D., &amp; Chan, K.-sik. (2008). Time series analysis with applications in R. New York: Springer.</li>
<li>Nugent, C. (n.d.). S&amp;P 500 stock data. Retrieved from <a href="https://www.kaggle.com/camnugent/sandp500">https://www.kaggle.com/camnugent/sandp500</a>.</li>
<li>Boudt, K. (n.d.). GARCH Models in R. Retrieved from <a href="https://www.datacamp.com/courses/garch-models-in-r">https://www.datacamp.com/courses/garch-models-in-r</a>.</li>
<li>Trapletti, A., &amp; Hornik, K. (n.d.). Package ‘tseries.’ Retrieved from <a href="https://cran.r-project.org/web/packages/tseries/tseries.pdf">https://cran.r-project.org/web/packages/tseries/tseries.pdf</a></li>
<li>Ghalanos, A., &amp; Kley, T. (n.d.). Package ‘rugarch.’ Retrieved from <a href="https://cran.r-project.org/web/packages/rugarch/rugarch.pdf">https://cran.r-project.org/web/packages/rugarch/rugarch.pdf</a></li>
<li>Glen, S. (2018, September 11). Ljung Box Test: Definition. Retrieved from <a href="https://www.statisticshowto.datasciencecentral.com/ljung-box-test/">https://www.statisticshowto.datasciencecentral.com/ljung-box-test/</a></li>
<li>Bollerslev, T. (1986). Generalized autoregressive conditional heteroskedasticity. Journal of Econometrics, 31(3), 307–327. doi: 10.1016/0304-4076(86)90063-1</li>
</ol>


<style>
.emojify {
	font-family: Apple Color Emoji, Segoe UI Emoji, NotoColorEmoji, Segoe UI Symbol, Android Emoji, EmojiSymbols;
	font-size: 2rem;
	vertical-align: middle;
}
@media screen and (max-width:650px) {
  .nowrap {
    display: block;
    margin: 25px 0;
  }
}
</style>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://adityatelange.github.io/hugo-PaperMod/tags/public-health-ggplot-shiny-server/">Public Health, ggplot, Shiny Server</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://adityatelange.github.io/hugo-PaperMod/posts/defaultriskcalculations/">
    <span class="title">« Prev</span>
    <br>
    <span>Navigating the Unknown</span>
  </a>
  <a class="next" href="https://adityatelange.github.io/hugo-PaperMod/posts/opioidcrisis/">
    <span class="title">Next »</span>
    <br>
    <span>Opioid Crisis Dashboard</span>
  </a>
</nav>


<div class="share-buttons">
    <a target="_blank" rel="noopener noreferrer" aria-label="share Modelling Changing Variance in Time Series on twitter"
        href="https://twitter.com/intent/tweet/?text=Modelling%20Changing%20Variance%20in%20Time%20Series&amp;url=https%3a%2f%2fadityatelange.github.io%2fhugo-PaperMod%2fposts%2fvariancemodelling%2f&amp;hashtags=PublicHealth%2cggplot%2cShinyServer">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-253.927,424.544c135.939,0 210.268,-112.643 210.268,-210.268c0,-3.218 0,-6.437 -0.153,-9.502c14.406,-10.421 26.973,-23.448 36.935,-38.314c-13.18,5.824 -27.433,9.809 -42.452,11.648c15.326,-9.196 26.973,-23.602 32.49,-40.92c-14.252,8.429 -30.038,14.56 -46.896,17.931c-13.487,-14.406 -32.644,-23.295 -53.946,-23.295c-40.767,0 -73.87,33.104 -73.87,73.87c0,5.824 0.613,11.494 1.992,16.858c-61.456,-3.065 -115.862,-32.49 -152.337,-77.241c-6.284,10.881 -9.962,23.601 -9.962,37.088c0,25.594 13.027,48.276 32.95,61.456c-12.107,-0.307 -23.448,-3.678 -33.41,-9.196l0,0.92c0,35.862 25.441,65.594 59.311,72.49c-6.13,1.686 -12.72,2.606 -19.464,2.606c-4.751,0 -9.348,-0.46 -13.946,-1.38c9.349,29.426 36.628,50.728 68.965,51.341c-25.287,19.771 -57.164,31.571 -91.8,31.571c-5.977,0 -11.801,-0.306 -17.625,-1.073c32.337,21.15 71.264,33.41 112.95,33.41Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Modelling Changing Variance in Time Series on linkedin"
        href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fadityatelange.github.io%2fhugo-PaperMod%2fposts%2fvariancemodelling%2f&amp;title=Modelling%20Changing%20Variance%20in%20Time%20Series&amp;summary=Modelling%20Changing%20Variance%20in%20Time%20Series&amp;source=https%3a%2f%2fadityatelange.github.io%2fhugo-PaperMod%2fposts%2fvariancemodelling%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Modelling Changing Variance in Time Series on reddit"
        href="https://reddit.com/submit?url=https%3a%2f%2fadityatelange.github.io%2fhugo-PaperMod%2fposts%2fvariancemodelling%2f&title=Modelling%20Changing%20Variance%20in%20Time%20Series">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Modelling Changing Variance in Time Series on facebook"
        href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fadityatelange.github.io%2fhugo-PaperMod%2fposts%2fvariancemodelling%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Modelling Changing Variance in Time Series on whatsapp"
        href="https://api.whatsapp.com/send?text=Modelling%20Changing%20Variance%20in%20Time%20Series%20-%20https%3a%2f%2fadityatelange.github.io%2fhugo-PaperMod%2fposts%2fvariancemodelling%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Modelling Changing Variance in Time Series on telegram"
        href="https://telegram.me/share/url?text=Modelling%20Changing%20Variance%20in%20Time%20Series&amp;url=https%3a%2f%2fadityatelange.github.io%2fhugo-PaperMod%2fposts%2fvariancemodelling%2f">
        <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
            <path
                d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
        </svg>
    </a>
</div>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2023 <a href="https://adityatelange.github.io/hugo-PaperMod/">Ray</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
